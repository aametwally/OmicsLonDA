---
title: "An Introduction to the OmicsLonDA Package"
author: "Ahmed Metwally, Tom Zhang"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{OmicsLonDA Package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

***
OmicsLonDA (Omics Longitudinal Differential Analysis) is a statistical framework
that provides robust identification of time intervals where omics features are
significantly different between groups. OmicsLonDA is based on 5 main steps:

1. Adjust measurements based on each subject's specific baseline
1. Global testing using linear mixed-effect model to select candidate features
and covariates for time intervals analysis
1. Fitting smoothing spline regression model
1. Monte Carlo simulation to generate the empirical distribution of the test
statistic
1. Inference of significant time intervals of omics features.

## Getting Started
### Prerequisites
* R(>= 3.6)

### Installation
Download the latest development code of OmicsLonDA from GitHub using devtools:
```{r}
library(devtools)
library(OmicsLonDA)
```

### Example
```{r}
library(OmicsLonDA)

## Load 1000 simulated features
data(diff_simulatedDataset_norm)
head(diff_simulatedDataset_norm[[1]])
```

### Apply OmicsLonDA on feature #1
```{r}
## Define the prediction timepoints 
points = seq(1, 200, length.out = 200)
output.omicslonda_diff_1 = omicslonda(formula = normalizedCount ~ Time, df =
                                      diff_simulatedDataset_norm[[1]],
                                      n.perm = 10, fit.method = "ssgaussian",
                                      points = points, text = "sim_f1",
                                      parall = FALSE, pvalue.threshold = 0.05,
                                      adjust.method = "BH",
                                      col = c("blue", "green"),
                                      prefix = "OmicsLonDA_clr_f1",
                                      ylabel = "CLR-NormalizedCount",
                                      DrawTestStatDist = FALSE,
                                      time.unit = "days")
```

## Bugs and Suggestions
OmicsLonDA is under active research development. Please report any
bugs/suggestions to Ahmed Metwally (ametwall@stanford.edu).

***
